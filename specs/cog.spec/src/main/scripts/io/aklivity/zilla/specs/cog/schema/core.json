{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$defs":
    {
        "namedRef":
        {
            "type": "string"
        },
        "terminal":
        {
            "enum": [ ]
        },
        "types":
        {
            "bindings":
            {
                "type": "string",
                "enum": [ ]
            },
            "vaults":
            {
                "type": "string",
                "enum": [ ]
            }
        }
    },
    "title": "Config",
    "type": "object",
    "additionalProperties": false,
    "properties":
    {
        "vaults":
        {
            "title": "Vaults",
            "type": "array",
            "items":
            {
                "title": "Items",
                "type": "object",
                "additionalProperties": false,
                "properties":
                {
                    "name":
                    {
                        "title": "Name",
                        "type": "string"
                    },
                    "type":
                    {
                        "title": "Type",
                        "$ref": "#/$defs/types/vaults"
                    },
                    "options":
                    {
                        "title": "Options",
                        "type": "object"
                    }
                },
                "required":
                [
                    "name",
                    "type"
                ],
                "allOf":
                [
                    true
                ]
            }
        },
        "bindings":
        {
            "title": "Bindings",
            "type": "array",
            "items":
            {
                "title": "Items",
                "type": "object",
                "additionalProperties": false,
                "properties":
                {
                    "vault": { "$ref": "#/$defs/namedRef" },
                    "entry":
                    {
                        "title": "Entry",
                        "type": "string"
                    },
                    "type":
                    {
                        "title": "Type",
                        "$ref": "#/$defs/types/bindings"
                    },
                    "kind":
                    {
                        "title": "Kind",
                        "type": "string"
                    },
                    "options":
                    {
                        "title": "Options",
                        "type": "object"
                    },
                    "routes":
                    {
                        "title": "Routes",
                        "type": "array",
                        "items":
                        {
                            "title": "Route",
                            "additionalProperties": false,
                            "properties":
                            {
                                "exit": { "$ref": "#/$defs/namedRef" },
                                "when":
                                {
                                    "title": "Conditions",
                                    "type": "array",
                                    "items":
                                    {
                                        "title": "Condition",
                                        "type": "object"
                                    }
                                },
                                "with":
                                {
                                    "title": "Overrides",
                                    "type": "array",
                                    "items":
                                    {
                                        "title": "Override",
                                        "type": "object"
                                    }
                                }
                            },
                            "required":
                            [
                                "exit"
                            ]
                        }
                    },
                    "exit":
                    {
                        "title": "Exit",
                        "type": "string"
                    }
                },
                "required":
                [
                    "entry",
                    "type",
                    "kind"
                ],
                "allOf":
                [
                    {
                        "if":
                        {
                            "not":
                            {
                                "properties": { "type": { "$ref": "#/$defs/terminal" } }
                            }
                        },
                        "then":
                        {
                            "anyOf":
                            [
                                {
                                    "required":
                                    [
                                        "exit"
                                    ]
                                },
                                {
                                    "required":
                                    [
                                        "routes"
                                    ]
                                }
                            ]
                        }
                    }
                ]
            }
        }
    }
}
